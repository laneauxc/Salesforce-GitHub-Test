# Search Functionality Documentation

## Overview

The GitHub Pages site includes a client-side search feature that allows users to search across all documentation content. The search is powered by a JSON index file that is generated from the markdown documentation files.

## How It Works

### Components

1. **Search Index** (`docs/search-index.json`)
   - JSON file containing indexed content from all documentation pages
   - Includes page titles, URLs, and cleaned content excerpts
   - Generated by the `generate-search-index.py` script

2. **Search Script** (`docs/assets/js/search.js`)
   - Client-side JavaScript that loads the search index
   - Implements search algorithm with scoring
   - Handles user input, displays results, and manages keyboard navigation

3. **Search UI** (`docs/assets/css/custom.css`)
   - Styles for the search input and results dropdown
   - Responsive design for mobile and desktop

## Using the Search

### For Users

1. Click on the search box in the sidebar
2. Type your search query (minimum 2 characters)
3. Results appear automatically below the search box
4. Press **Enter** to navigate to the first result
5. Click any result to navigate to that page
6. Press **Escape** to close the results

### Search Features

- **Real-time results**: Search results appear as you type
- **Smart scoring**: Title matches are prioritized over content matches
- **Context excerpts**: See where your search term appears in the content
- **Highlighted matches**: Search terms are highlighted in yellow
- **Keyboard navigation**: Use Enter to navigate, Escape to close

## Maintaining the Search Index

### When to Regenerate

The search index should be regenerated whenever documentation content changes:
- New documentation pages are added
- Existing pages are updated
- Pages are deleted or renamed

### How to Regenerate

Run the search index generation script from the repository root:

```bash
python3 scripts/generate-search-index.py
```

This will:
1. Scan all markdown files in the `docs/` directory
2. Extract titles and content
3. Clean and process the text
4. Generate a new `docs/search-index.json` file

### Automation

For automated regeneration, you can add this to your CI/CD workflow:

```yaml
- name: Generate search index
  run: python3 scripts/generate-search-index.py
  
- name: Commit search index
  run: |
    git config user.name "GitHub Actions"
    git config user.email "actions@github.com"
    git add docs/search-index.json
    git commit -m "Update search index" || true
    git push || true
```

## Technical Details

### Search Algorithm

The search implementation uses a simple but effective scoring system:

1. **Title Matching** (high priority)
   - Each query term found in the title adds 10 points
   - Exact title match adds 20 additional points

2. **Content Matching** (lower priority)
   - Each query term found in content adds 1 point
   - Multiple occurrences add 0.5 points each

3. **Results are sorted by score** (highest first)

4. **Top 10 results** are displayed

### Performance

- **Index Size**: Approximately 6KB for 12 documentation pages
- **Search Speed**: Near-instantaneous for typical documentation sites
- **Debouncing**: 300ms delay prevents excessive searching while typing
- **Memory Usage**: Minimal - index is loaded once on page load

### Browser Compatibility

The search functionality works in all modern browsers that support:
- ES6+ JavaScript (async/await, arrow functions, etc.)
- Fetch API
- CSS Grid and Flexbox

## Troubleshooting

### Search Not Working

1. **Check the browser console** for errors
2. **Verify search-index.json exists** at `/Salesforce-GitHub-Test/search-index.json`
3. **Ensure search.js is loaded** after nav.js in the page

### No Results Found

1. **Check minimum query length** - at least 2 characters required
2. **Verify search index is up to date** - regenerate if needed
3. **Check content exists** in the search index file

### Results Not Highlighted

1. **Verify custom.css is loaded** properly
2. **Check for CSS conflicts** with other stylesheets
3. **Test with browser dev tools** to inspect the mark elements

## Future Enhancements

Potential improvements for the search functionality:

- [ ] Add support for search filters (by section, date, etc.)
- [ ] Implement fuzzy matching for typo tolerance
- [ ] Add search analytics to track popular queries
- [ ] Support for advanced search operators (AND, OR, NOT)
- [ ] Add autocomplete suggestions
- [ ] Improve mobile search UX with full-screen results
- [ ] Add search result pagination for large result sets

## Files Modified

- `docs/_layouts/default.html` - Added search.js script
- `docs/assets/css/custom.css` - Added search result styles
- `docs/assets/js/search.js` - New search functionality
- `docs/assets/js/nav.js` - Removed old navigation-only search
- `docs/search-index.json` - Generated search index
- `scripts/generate-search-index.py` - Search index generator
